<!DOCTYPE html>

<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FEZEWRW546"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FEZEWRW546');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1941542042191977" crossorigin="anonymous"></script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6T055ZVFET">
// ===== Mobile Slide-Over Menu Script =====
function toggleMenu() {
    const nav = document.querySelector('.tab-nav');
    const isOpen = nav.classList.toggle('open');
    if (isOpen) {
        document.body.classList.add('menu-open');
    } else {
        document.body.classList.remove('menu-open');
    }
}

// Close menu when clicking outside or selecting a tab
document.addEventListener('click', function(e) {
    const nav = document.querySelector('.tab-nav');
    const toggleBtn = document.querySelector('.menu-toggle');
    if (nav.classList.contains('open') &&
        !nav.contains(e.target) &&
        !toggleBtn.contains(e.target)) {
        nav.classList.remove('open');
        document.body.classList.remove('menu-open');
    }
});

// Auto-close on tab click (for mobile/iPad)
document.querySelectorAll('.tab-button').forEach(btn => {
    btn.addEventListener('click', () => {
        const nav = document.querySelector('.tab-nav');
        if (window.innerWidth <= 1024) {
            nav.classList.remove('open');
            document.body.classList.remove('menu-open');
        }
    });
});
// ===== End Mobile Slide-Over Menu Script =====

</script>
<script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6T055ZVFET');
    
// ===== Mobile Slide-Over Menu Script =====
function toggleMenu() {
    const nav = document.querySelector('.tab-nav');
    const isOpen = nav.classList.toggle('open');
    if (isOpen) {
        document.body.classList.add('menu-open');
    } else {
        document.body.classList.remove('menu-open');
    }
}

// Close menu when clicking outside or selecting a tab
document.addEventListener('click', function(e) {
    const nav = document.querySelector('.tab-nav');
    const toggleBtn = document.querySelector('.menu-toggle');
    if (nav.classList.contains('open') &&
        !nav.contains(e.target) &&
        !toggleBtn.contains(e.target)) {
        nav.classList.remove('open');
        document.body.classList.remove('menu-open');
    }
});

// Auto-close on tab click (for mobile/iPad)
document.querySelectorAll('.tab-button').forEach(btn => {
    btn.addEventListener('click', () => {
        const nav = document.querySelector('.tab-nav');
        if (window.innerWidth <= 1024) {
            nav.classList.remove('open');
            document.body.classList.remove('menu-open');
        }
    });
});
// ===== End Mobile Slide-Over Menu Script =====

</script>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Comprehensive Investment Calculator</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js">
// ===== Mobile Slide-Over Menu Script =====
function toggleMenu() {
    const nav = document.querySelector('.tab-nav');
    const isOpen = nav.classList.toggle('open');
    if (isOpen) {
        document.body.classList.add('menu-open');
    } else {
        document.body.classList.remove('menu-open');
    }
}

// Close menu when clicking outside or selecting a tab
document.addEventListener('click', function(e) {
    const nav = document.querySelector('.tab-nav');
    const toggleBtn = document.querySelector('.menu-toggle');
    if (nav.classList.contains('open') &&
        !nav.contains(e.target) &&
        !toggleBtn.contains(e.target)) {
        nav.classList.remove('open');
        document.body.classList.remove('menu-open');
    }
});

// Auto-close on tab click (for mobile/iPad)
document.querySelectorAll('.tab-button').forEach(btn => {
    btn.addEventListener('click', () => {
        const nav = document.querySelector('.tab-nav');
        if (window.innerWidth <= 1024) {
            nav.classList.remove('open');
            document.body.classList.remove('menu-open');
        }
    });
});
// ===== End Mobile Slide-Over Menu Script =====

</script>
<style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 3;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        /* Global Currency Selector Styles (Dropdown) */
        .currency-selector-global {
            background: #f0f4f8;
            padding: 15px 40px;
            border-bottom: 1px solid #e0e4e8;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 15px;
            flex-wrap: wrap;
        }

        .currency-selector-global label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1em;
            white-space: nowrap;
        }

        .currency-dropdown {
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1em;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23667eea%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13%205.7L146.2%20215.9%2018.8%2075.1a17.6%2017.6%200%200%200-25.2-24.8c-7%206.7-7.2%2017.9-.6%2025.5l131.3%20140.2c6.4%206.8%2017.2%206.8%2023.6%200l131.3-140.2c6.6-7.6%206.4-18.8-.6-25.5a17.6%2017.6%200%200%200-12.8-5.7z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 10px top 50%;
            background-size: 12px;
            padding-right: 30px;
        }

        .currency-dropdown:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .main-content-wrapper {
            display: flex;
            flex-grow: 1;
        }

        /* Tab Navigation Styles */
        .tab-nav {
            display: flex;
            flex-direction: column;
            width: 220px;
            background: #e9ecef;
            border-right: 1px solid #dee2e6;
            padding: 20px 0;
            flex-shrink: 0;
        }

        .tab-button {
            padding: 15px 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            color: #495057;
            border: none;
            background: transparent;
            transition: background 0.3s ease, color 0.3s ease;
            text-align: left;
            border-radius: 0;
            margin-bottom: 5px;
        }

        .tab-button:hover {
            background: #f1f3f5;
        }

        .tab-button.active {
            color: #667eea;
            border-left: 5px solid #667eea;
            background: white;
            border-bottom: none;
            padding-left: 20px;
        }

        /* Calculator Body and Input Styles */
        .calculator-body {
            padding: 40px;
            flex-grow: 1;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .input-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .input-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .frequency-group {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }

        .frequency-option {
            flex: 1;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .frequency-option.active {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .amount-in-words {
            font-size: 0.9em;
            color: #667eea;
            margin-top: 5px;
            font-weight: 500;
            min-height: 20px;
        }
        .amount-in-words { display: block !important; min-height: 20px; }

        .amount-in-words.japanese {
            font-family: 'Meiryo', 'Yu Gothic', 'Hiragino Sans', sans-serif;
        }
        .amount-in-words { display: block !important; min-height: 20px; }

        .calculate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.3em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 1px;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        /* Results Section Styles */
        .results-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
            margin-top: 20px;
            display: none;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        .result-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .result-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .result-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
            text-align: center;
        }

        .result-words {
            font-size: 0.9em;
            color: #667eea;
            margin-top: 8px;
            font-weight: 500;
            text-align: center;
        }

        .result-words.japanese {
            font-family: 'Meiryo', 'Yu Gothic', 'Hiragino Sans', sans-serif;
        }

        .breakdown-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .breakdown-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .breakdown-item {
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
            flex-wrap: wrap;
        }

        .breakdown-item:last-child {
            border-bottom: none;
            font-weight: bold;
            color: #667eea;
        }

        .breakdown-value {
            text-align: right;
        }

        .breakdown-words {
            font-size: 0.8em;
            color: #667eea;
            margin-top: 2px;
        }

        .breakdown-words.japanese {
            font-family: 'Meiryo', 'Yu Gothic', 'Hiragino Sans', sans-serif;
        }
        
        /* New Styles for Strategy Comparison Tab */
        .strategy-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 30px;
        }

        .strategy-column h2 {
            font-size: 1.5em;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .comparison-output-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: start;
        }

        .comparison-results-table {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .comparison-results-table > div {
            padding: 10px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .comparison-results-table > div:last-child,
        .comparison-results-table > div:nth-last-child(2),
        .comparison-results-table > div:nth-last-child(3) {
            border-bottom: none;
        }

        .comparison-results-table .header {
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border-radius: 6px;
            padding: 12px 10px;
            text-align: center;
        }

        .comparison-results-table .metric-label {
            font-weight: 600;
            color: #495057;
        }

        .comparison-results-table .result-value-cell {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1em;
            text-align: right;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            position: relative;
            min-height: 400px;
        }

        .info-tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .info-tooltip::after {
            content: "ℹ️";
            font-size: 0.9em;
        }

        .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #2c3e50;
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9em;
        }

        .info-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .error-message {
            color: #e74c3c;
            font-size: 0.9em;
            margin-top: 5px;
            display: none;
        }

        /* Custom Message Box Styles */
        #messageBoxBackground {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #messageBoxContent {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 400px;
            width: 90%;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Permanent Disclaimer */
        .permanent-disclaimer {
            font-size: 0.8em;
            color: #555;
            margin-top: 30px;
            padding: 15px;
            border-top: 1px solid #eee;
            text-align: justify;
            line-height: 1.5;
            margin-bottom: 20px;
        }

        /* Feedback Link Styles */
        .feedback-link-container {
            text-align: center;
            padding: 20px;
            background-color: #f8f9fa;
            border-top: 1px solid #dee2e6;
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
        }

        .feedback-link {
            display: inline-block;
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .feedback-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }


        @media (max-width: 992px) {
            .comparison-output-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            .currency-selector-global {
                padding: 10px 20px;
                flex-direction: column;
                align-items: flex-start;
            }
            .currency-selector-global label {
                margin-bottom: 10px;
            }
            .currency-dropdown {
                width: 100%;
            }
            .main-content-wrapper {
                flex-direction: column;
            }
            .tab-nav {
                width: 100%;
                flex-direction: row;
                justify-content: space-around;
                border-bottom: 1px solid #dee2e6;
                border-right: none;
                padding: 10px 0;
            }
            .tab-button {
                flex-grow: 1;
                text-align: center;
                border-left: none;
                border-bottom: 3px solid transparent;
                margin-bottom: 0;
            }
            .tab-button.active {
                border-left: none;
                border-bottom: 3px solid #667eea;
                padding-left: 15px;
            }
            .calculator-body {
                padding: 20px;
            }

            .input-section {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8em;
            }

            /* On small screens, results should stack */
            .results-grid {
                grid-template-columns: 1fr;
            }

            .breakdown-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .breakdown-value {
                text-align: left;
            }
            
            .strategy-container {
                grid-template-columns: 1fr;
                gap: 30px;
            }

            .comparison-results-table {
                grid-template-columns: 1fr 1fr 1fr;
                gap: 5px;
            }

            .comparison-results-table > div {
                display: grid;
                grid-template-columns: 1fr 1fr;
                align-items: center;
                text-align: left;
            }

            .comparison-results-table .header {
                display: none; /* Hide header row on mobile */
            }

            .comparison-results-table .result-value-cell {
                text-align: right;
            }

            .comparison-results-table .metric-label::before {
                content: attr(data-label);
                font-weight: bold;
                margin-right: 10px;
            }
        }
    
/* ===== Mobile & iPad Responsive Menu Enhancements ===== */
.menu-toggle {
    display: none;
}

@media (max-width: 1024px) {
    .menu-toggle {
        display: block;
        position: absolute;
        top: 25px;
        left: 25px;
        background: transparent;
        border: none;
        color: white;
        font-size: 1.8em;
        cursor: pointer;
        z-index: 1201;
    }
    .menu-toggle:focus {
        outline: none;
    }

    .tab-nav {
        position: fixed;
        top: 0;
        left: 0;
        height: 100%;
        width: 250px;
        background: #e9ecef;
        flex-direction: column;
        padding-top: 100px;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: 2px 0 10px rgba(0,0,0,0.2);
        z-index: 1200;
    }
    .tab-nav.open {
        transform: translateX(0);
    }

    .tab-button {
        display: block;
        width: 100%;
        text-align: left;
        padding: 15px 25px;
        border-bottom: 1px solid #dee2e6;
        background: transparent;
        font-size: 1.1em;
    }

    .tab-button.active {
        background: #fff;
        border-left: 5px solid #667eea;
        color: #667eea;
    }

    body.menu-open::after {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.4);
        z-index: 1100;
    }

    .main-content-wrapper {
        flex-direction: column;
        overflow-x: hidden;
    }

    .calculator-body,
    .input-section,
    .results-grid {
        width: 100%;
        overflow-x: hidden;
    }
}
/* ===== End Mobile & iPad Responsive Menu Enhancements ===== */


/* Strategy Comparison specific styles (keeps desktop intact) */
.comparison-results-table {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 0;
  background: #fff;
  border-radius: 10px;
  overflow: hidden;
}
.comparison-results-table > div {
  padding: 12px;
  border-bottom: 1px solid #eee;
  text-align: center;
}
.comparison-results-table .header {
  font-weight: 700;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: #fff;
}
.comparison-results-table .metric-label {
  font-weight: 600;
  color: #333;
  background: #f8f9fa;
  text-align: left;
}

/* words rows */
.result-words { font-size: 0.85em; color: #667eea; text-align:right; padding-top:6px; }

/* Mobile-only improvements */
@media (max-width: 768px) {
  .strategy-column { background:#fff; border-radius:10px; padding:12px; box-shadow:0 4px 12px rgba(0,0,0,0.05); }
  .strategy-column h2 { font-size:1.05em; margin:0 0 10px 0; padding:8px 10px; background:transparent; cursor:pointer; border-radius:6px; text-align:center;}
  .strategy-column.collapsed .input-group { display:none; }

  .comparison-results-table { grid-template-columns: 1fr 1fr 1fr; font-size:0.92em; }
  .comparison-results-table .metric-label { text-align:left; padding-left:10px; }
  .comparison-results-table > div { padding:8px; }

  /* Hide header row visually but keep accessibility */
  .comparison-results-table .header { display:none; }

  /* Sticky compare button on mobile */
  #compareBtn { position: sticky; bottom:12px; z-index:200; width:calc(100% - 40px); margin:auto; }

  /* Chart size fix */
  .chart-container { padding:12px; }
  #comparisonChart { height:260px !important; width:100% !important; }

  /* result words alignment */
  .comparison-results-table .result-words { text-align:right; padding-right:10px; }
}

/* Collapsible header visual hint */
.collapsible-h2::after { content: " ▾"; font-size:0.9em; margin-left:6px; color:#667eea; }
.collapsible-h2.collapsed::after { content: " ▸"; }

</style>
<style>
/* Fix for Strategy Comparison metric layout */
#comparisonTable {
  display: table;
  width: 100%;
}
#comparisonTable .header {
  display: table-row;
  font-weight: bold;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: #fff;
}
#comparisonTable .metric-label,
#comparisonTable .result-value-cell {
  display: table-cell;
  padding: 10px;
  border-bottom: 1px solid #eee;
  text-align: center;
}
#comparisonTable .metric-label {
  text-align: left;
  font-weight: 600;
  background: #f8f9fa;
}
@media (max-width:768px) {
  #comparisonTable { display:block; }
  #comparisonTable .metric-label, #comparisonTable .result-value-cell {
    display:block;
    text-align:left;
  }
}
</style>
<style>
@media (max-width: 768px) {
  .comparison-results-table thead {
    display: none;
  }
  .comparison-results-table, .comparison-results-table tbody, .comparison-results-table tr, .comparison-results-table td {
    display: block;
    width: 100%;
  }
  .comparison-results-table tr {
    margin-bottom: 15px;
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  }
  .comparison-results-table td {
    text-align: right;
    padding: 8px 10px;
    position: relative;
  }
  .comparison-results-table td::before {
    content: attr(data-label);
    position: absolute;
    left: 10px;
    width: 50%;
    padding-right: 10px;
    font-weight: 600;
    text-align: left;
    color: #333;
  }
}
</style>
<style>
/* Minimal override: make comparison table and chart full width edge-to-edge on desktop */
.comparison-output-container {
  display: flex;
  flex-direction: column;
  width: 100%;
  gap: 20px;
  margin-top: 20px;
}
.comparison-results-table, #comparisonChart, .chart-container {
  width: 100% !important;
  max-width: 100% !important;
}
@media (max-width: 767px) {
  .comparison-results-table { font-size: 0.9em; }
  #comparisonChart { width: 100% !important; height: auto !important; }
}
</style><style>
/* ===== Align Comparison Results Width with Input Cards ===== */
.comparison-results-wrapper {
  width: 100%;
  max-width: 900px; /* match approximate width of input cards container */
  margin: 30px auto;
  padding: 25px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  color: #fff;
  box-sizing: border-box;
}

.comparison-results-wrapper .card, 
.comparison-results-wrapper .comparison-results-table {
  background: #fff;
  color: #333;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  padding: 20px;
}

.comparison-output-container {
  display: flex;
  flex-direction: column;
  width: 100%;
  gap: 20px;
  margin-top: 20px;
}

.comparison-results-table, #comparisonChart, .chart-container {
  width: 100% !important;
  max-width: 100% !important;
}

@media (max-width: 767px) {
  .comparison-results-wrapper {
    max-width: 100%;
    padding: 20px;
    border-radius: 10px;
  }
  .comparison-results-table { font-size: 0.9em; }
  #comparisonChart { width: 100% !important; height: auto !important; }
}
</style>
<style>
/* Strategy Comparison Chart Mobile Visibility Fix (Controlled Height) */
@media (max-width: 768px) {
    /* 1. Container: Define a controlled height using viewport units (vh) */
    .chart-container {
        width: 100% !important; 
        
        /* Set height to 40% of the viewport height (e.g., screen height) */
        height: 40vh !important; 
        
        /* Ensure it's never smaller than 250px and never larger than 450px */
        min-height: 250px !important; 
        max-height: 450px !important; 
        
        position: relative !important; 
    }
    
    /* 2. Chart Canvas: Ensure it fills the controlled container */
    #comparisonChart {
        width: 100% !important;
        height: 100% !important; /* Fills the container's controlled height and width */
        display: block !important;
        
        /* Important: remove any conflicting min/max height properties from the canvas */
        min-height: 0 !important;
        max-height: none !important;
    }
}
</style>

<!--Code fix-->
<style>
/* Fix for Centered Future Value Playcard Results */

/* This targets the container holding the result cards, assuming it's a flexbox/grid layout */
/* If the overall layout is a grid or flex container, this is the most reliable way to center content */
.strategy-results-cards-container {
    /* If this is the main container for the cards, you can center the cards themselves: */
    justify-content: center !important; 
    align-items: center !important;
}

/* This targets the specific element that holds the calculated number value */
/* Based on the code snippet, these are likely the IDs for the final values */
#comparisonFinalValueA,
#comparisonFinalValueB,
#comparisonTotalContributionsA,
#comparisonTotalContributionsB,
#comparisonTotalGainsA,
#comparisonTotalGainsB {
    /* Center the text inside the element */
    text-align: center !important;
    
    /* Ensure the element takes up enough width to center its content properly */
    display: block !important; 
    width: 100% !important;
}

/* If the values are inside a generic class (e.g., used for all result numbers) */
.playcard .result-value, 
.playcard .value-display {
    text-align: center !important;
    display: block !important;
}
</style>

</head>
<body>
<div class="container">
<div class="header">
<button class="menu-toggle" onclick="toggleMenu()">☰</button>
<h1>Investment Calculator</h1>
<p>Calculate your investment's future value, required contributions, or manage withdrawals</p>
</div>
<div class="currency-selector-global">
<label for="globalCurrencySelect">
                Select Currency
                <span class="info-tooltip">
<span class="tooltip-text">Choose your preferred currency for calculations across all tabs</span>
</span>
</label>
<select class="currency-dropdown" id="globalCurrencySelect">
<option data-symbol="₹" value="INR">₹ INR</option>
<option data-symbol="$" value="USD">$ USD</option>
<option data-symbol="€" value="EUR">€ EUR</option>
<option data-symbol="¥" value="JPY">¥ JPY</option>
</select>
</div>
<div class="main-content-wrapper">
<div class="tab-nav">
<button class="tab-button active" onclick="showTab('futureValueTab')">Future Value</button>
<button class="tab-button" onclick="showTab('targetInvestmentTab')">Target Investment</button>
<button class="tab-button" onclick="showTab('swpCalculatorTab')">SWP Calculator</button>
<button class="tab-button" onclick="showTab('emergencyFundTab')">Emergency Fund &amp; Debt Impact</button>
<button class="tab-button" onclick="showTab('strategyComparisonTab')">Strategy Comparison</button>
<button class="tab-button" onclick="window.location.href='feedback.html'">Provide Your Feedback</button>
<button class="tab-button" onclick="window.open('blog.html', '_blank')">Read Our Blog →</button>
</div>
<div class="calculator-body">
<div class="tab-content active" id="futureValueTab">
<div class="input-section">
<div class="input-group">
<label for="initialInvestment">
                                Initial Lump Sum Investment (<span id="initialCurrencySymbol">₹</span>)
                                <span class="info-tooltip">
<span class="tooltip-text">The amount you can invest today as a one-time payment</span>
</span>
</label>
<input id="initialInvestment" oninput="formatNumberInput(this); updateAmountInWords('initialInvestment', 'initialWords')" placeholder="1,00,000" type="text"/>
<div class="amount-in-words" id="initialWords"></div>
</div>
<div class="input-group">
<label for="recurringAmount">
                                Recurring Investment Amount (<span id="recurringCurrencySymbol">₹</span>)
                                <span class="info-tooltip">
<span class="tooltip-text">Amount you plan to invest regularly</span>
</span>
</label>
<input id="recurringAmount" oninput="formatNumberInput(this); updateAmountInWords('recurringAmount', 'recurringWords')" placeholder="10,000" type="text"/>
<div class="amount-in-words" id="recurringWords"></div>
<div class="frequency-group">
<div class="frequency-option active" data-frequency="monthly">Monthly</div>
<div class="frequency-option" data-frequency="yearly">Yearly</div>
</div>
</div>
<div class="input-group">
<label for="investmentDuration">
                                Investment Duration (Years)
                                <span class="info-tooltip">
<span class="tooltip-text">Number of years you plan to make regular investments</span>
</span>
</label>
<input id="investmentDuration" max="50" min="1" placeholder="10" type="number"/>
</div>
<div class="input-group">
<label for="holdingPeriod">
                                Total Holding Period (Years)
                                <span class="info-tooltip">
<span class="tooltip-text">Total years to hold investments (must be at least equal to investment duration)</span>
</span>
</label>
<input id="holdingPeriod" max="50" min="1" placeholder="15" type="number"/>
<div class="error-message" id="holdingPeriodError">
                                Holding period must be at least equal to investment duration
                            </div>
</div>
<div class="input-group">
<label for="annualReturn">
                                Expected Annual Rate of Return (%)
                                <span class="info-tooltip">
<span class="tooltip-text">Expected annual return before taxes and inflation</span>
</span>
</label>
<input id="annualReturn" max="30" min="0" placeholder="12" step="0.1" type="number"/>
</div>
<div class="input-group">
<label for="taxRate">
                                Tax Rate (%)
                                <span class="info-tooltip">
<span class="tooltip-text">Tax rate applied to investment gains</span>
</span>
</label>
<input id="taxRate" max="50" min="0" placeholder="10" step="0.1" type="number"/>
</div>
<div class="input-group">
<label for="inflationRate">
                                Inflation Rate (%)
                                <span class="info-tooltip">
<span class="tooltip-text">Expected annual inflation rate</span>
</span>
</label>
<input id="inflationRate" max="15" min="0" placeholder="6" step="0.1" type="number"/>
</div>
</div>
<button class="calculate-btn" onclick="calculateInvestment()">Calculate Future Value</button>
<div class="results-section" id="futureValueResultsSection">
<div class="results-grid">
<div class="result-card">
<h3>Future Value (Nominal)</h3>
<div class="result-value" id="futureValueNominal">₹0</div>
<div class="result-words" id="futureValueNominalWords"></div>
</div>
<div class="result-card">
<h3>Future Value (Real)</h3>
<div class="result-value" id="futureValueReal">₹0</div>
<div class="result-words" id="futureValueRealWords"></div>
</div>
<div class="result-card">
<h3>Total Contributions</h3>
<div class="result-value" id="totalContributions">₹0</div>
<div class="result-words" id="totalContributionsWords"></div>
</div>
<div class="result-card">
<h3>Total Gains</h3>
<div class="result-value" id="totalGains">₹0</div>
<div class="result-words" id="totalGainsWords"></div>
</div>
</div>
<div class="breakdown-section">
<h3>Detailed Breakdown</h3>
<div class="breakdown-item">
<span>Initial Investment:</span>
<div class="breakdown-value">
<span id="breakdownInitial">₹0</span>
<div class="breakdown-words" id="breakdownInitialWords"></div>
</div>
</div>
<div class="breakdown-item">
<span>Total Recurring Contributions:</span>
<div class="breakdown-value">
<span id="breakdownRecurring">₹0</span>
<div class="breakdown-words" id="breakdownRecurringWords"></div>
</div>
</div>
<div class="breakdown-item">
<span>Gross Investment Gains:</span>
<div class="breakdown-value">
<span id="breakdownGrossGains">₹0</span>
<div class="breakdown-words" id="breakdownGrossGainsWords"></div>
</div>
</div>
<div class="breakdown-item">
<span>Taxes on Gains:</span>
<div class="breakdown-value">
<span id="breakdownTaxes">₹0</span>
<div class="breakdown-words" id="breakdownTaxesWords"></div>
</div>
</div>
<div class="breakdown-item">
<span>Net Investment Gains:</span>
<div class="breakdown-value">
<span id="breakdownNetGains">₹0</span>
<div class="breakdown-words" id="breakdownNetGainsWords"></div>
</div>
</div>
<div class="breakdown-item">
<span>Final Value (After Tax):</span>
<div class="breakdown-value">
<span id="breakdownFinalValue">₹0</span>
<div class="breakdown-words" id="breakdownFinalValueWords"></div>
</div>
</div>
<div class="breakdown-item">
<span>Real Value (Inflation Adjusted):</span>
<div class="breakdown-value">
<span id="breakdownRealValue">₹0</span>
<div class="breakdown-words" id="breakdownRealValueWords"></div>
</div>
</div>
</div>
</div>
<div class="permanent-disclaimer">
                        These calculations are based on standard formulas and may not reflect actual outcomes in real-life scenarios. They are provided for reference purposes only and should not be construed as professional advice. Users are encouraged to consult a qualified professional for guidance specific to their individual circumstances.
                    </div>
</div>
<div class="tab-content" id="targetInvestmentTab">
<div class="input-section">
<div class="input-group">
<label for="targetAmount">
                                Target Amount (<span id="targetCurrencySymbol">₹</span>)
                                <span class="info-tooltip">
<span class="tooltip-text">The desired future value of your investment</span>
</span>
</label>
<input id="targetAmount" oninput="formatNumberInput(this); updateAmountInWords('targetAmount', 'targetWords')" placeholder="1,00,00,000" type="text"/>
<div class="amount-in-words" id="targetWords"></div>
</div>
<div class="input-group">
<label for="targetInitialInvestment">
                                Initial Lump Sum Investment (<span id="targetInitialCurrencySymbol">₹</span>)
                                <span class="info-tooltip">
<span class="tooltip-text">The amount you can invest today as a one-time payment for your target</span>
</span>
</label>
<input id="targetInitialInvestment" oninput="formatNumberInput(this); updateAmountInWords('targetInitialInvestment', 'targetInitialWords')" placeholder="0" type="text"/>
<div class="amount-in-words" id="targetInitialWords"></div>
</div>
<div class="input-group">
<label for="targetDuration">
                                Investment Duration (Years)
                                <span class="info-tooltip">
<span class="tooltip-text">Number of years to achieve your target amount</span>
</span>
</label>
<input id="targetDuration" max="50" min="1" placeholder="20" type="number"/>
</div>
<div class="input-group">
<label for="targetAnnualReturn">
                                Expected Annual Rate of Return (%)
                                <span class="info-tooltip">
<span class="tooltip-text">Expected annual return before taxes and inflation</span>
</span>
</label>
<input id="targetAnnualReturn" max="30" min="0" placeholder="12" step="0.1" type="number"/>
</div>
<div class="input-group">
<label for="targetTaxRate">
                                Tax Rate (%)
                                <span class="info-tooltip">
<span class="tooltip-text">Tax rate applied to investment gains</span>
</span>
</label>
<input id="targetTaxRate" max="50" min="0" placeholder="10" step="0.1" type="number"/>
</div>
<div class="input-group">
<label for="targetInflationRate">
                                Inflation Rate (%)
                                <span class="info-tooltip">
<span class="tooltip-text">Expected annual inflation rate (for real value calculation)</span>
</span>
</label>
<input id="targetInflationRate" max="15" min="0" placeholder="6" step="0.1" type="number"/>
</div>
</div>
<button class="calculate-btn" onclick="calculateTargetInvestment()">Calculate Required Contribution</button>
<div class="results-section" id="targetInvestmentResultsSection">
<div class="results-grid">
<div class="result-card">
<h3>Required Monthly Contribution</h3>
<div class="result-value" id="requiredMonthlyContribution">₹0</div>
<div class="result-words" id="requiredMonthlyContributionWords"></div>
</div>
<div class="result-card">
<h3>Required Yearly Contribution</h3>
<div class="result-value" id="requiredYearlyContribution">₹0</div>
<div class="result-words" id="requiredYearlyContributionWords"></div>
</div>
<div class="result-card">
<h3>Total Contributions</h3>
<div class="result-value" id="targetTotalContributions">₹0</div>
<div class="result-words" id="targetTotalContributionsWords"></div>
</div>
<div class="result-card">
<h3>Total Gains</h3>
<div class="result-value" id="targetTotalGains">₹0</div>
<div class="result-words" id="targetTotalGainsWords"></div>
</div>
</div>
<div class="breakdown-section">
<h3>Detailed Breakdown</h3>
<div class="breakdown-item">
<span>Target Amount:</span>
<div class="breakdown-value">
<span id="breakdownTargetAmount">₹0</span>
<div class="breakdown-words" id="breakdownTargetAmountWords"></div>
</div>
</div>
<div class="breakdown-item">
<span>Initial Investment:</span>
<div class="breakdown-value">
<span id="breakdownTargetInitial">₹0</span>
<div class="breakdown-words" id="breakdownTargetInitialWords"></div>
</div>
</div>
<div class="breakdown-item">
<span>Total Recurring Contributions:</span>
<div class="breakdown-value">
<span id="breakdownTargetRecurring">₹0</span>
<div class="breakdown-words" id="breakdownTargetRecurringWords"></div>
</div>
</div>
<div class="breakdown-item">
<span>Gross Investment Gains:</span>
<div class="breakdown-value">
<span id="breakdownTargetGrossGains">₹0</span>
<div class="breakdown-words" id="breakdownTargetGrossGainsWords"></div>
</div>
</div>
<div class="breakdown-item">
<span>Taxes on Gains:</span>
<div class="breakdown-value">
<span id="breakdownTargetTaxes">₹0</span>
<div class="breakdown-words" id="breakdownTargetTaxesWords"></div>
</div>
</div>
<div class="breakdown-item">
<span>Net Investment Gains:</span>
<div class="breakdown-value">
<span id="breakdownTargetNetGains">₹0</span>
<div class="breakdown-words" id="breakdownTargetNetGainsWords"></div>
</div>
</div>
</div>
</div>
<div class="permanent-disclaimer">
                        These calculations are based on standard formulas and may not reflect actual outcomes in real-life scenarios. They are provided for reference purposes only and should not be construed as professional advice. Users are encouraged to consult a qualified professional for guidance specific to their individual circumstances.
                    </div>
</div>
<div class="tab-content" id="swpCalculatorTab">
<div class="input-section">
<div class="input-group">
<label for="swpInitialAmount">
                                Initial Investment Amount (<span id="swpInitialCurrencySymbol">₹</span>)
                                <span class="info-tooltip">
<span class="tooltip-text">The lump sum amount invested for SWP</span>
</span>
</label>
<input id="swpInitialAmount" oninput="formatNumberInput(this); updateAmountInWords('swpInitialAmount', 'swpInitialWords')" placeholder="50,00,000" type="text"/>
<div class="amount-in-words" id="swpInitialWords"></div>
</div>
<div class="input-group">
<label for="deferWithdrawalFor">
                                Defer Withdrawal For (Years)
                                <span class="info-tooltip">
<span class="tooltip-text">Number of years to hold investment before starting withdrawals</span>
</span>
</label>
<input id="deferWithdrawalFor" max="30" min="0" placeholder="0" type="number"/>
</div>
<div class="input-group">
<label for="monthlyWithdrawalAmount">
                                Monthly Withdrawal Amount (<span id="swpWithdrawalCurrencySymbol">₹</span>)
                                <span class="info-tooltip">
<span class="tooltip-text">The fixed amount to withdraw each month</span>
</span>
</label>
<input id="monthlyWithdrawalAmount" oninput="formatNumberInput(this); updateAmountInWords('monthlyWithdrawalAmount', 'swpWithdrawalWords')" placeholder="25,000" type="text"/>
<div class="amount-in-words" id="swpWithdrawalWords"></div>
</div>
<div class="input-group">
<label for="withdrawalDuration">
                                Withdrawal Duration (Years)
                                <span class="info-tooltip">
<span class="tooltip-text">Total years for which you want to withdraw</span>
</span>
</label>
<input id="withdrawalDuration" max="50" min="1" placeholder="15" type="number"/>
</div>
<div class="input-group">
<label for="swpAnnualReturn">
                                Expected Annual Rate of Return (%)
                                <span class="info-tooltip">
<span class="tooltip-text">Expected annual return before taxes and inflation</span>
</span>
</label>
<input id="swpAnnualReturn" max="30" min="0" placeholder="8" step="0.1" type="number"/>
</div>
<div class="input-group">
<label for="swpTaxRate">
                                Tax Rate (%)
                                <span class="info-tooltip">
<span class="tooltip-text">Tax rate applied to investment gains</span>
</span>
</label>
<input id="swpTaxRate" max="50" min="0" placeholder="10" step="0.1" type="number"/>
</div>
<div class="input-group">
<label for="swpInflationRate">
                                Inflation Rate (%)
                                <span class="info-tooltip">
<span class="tooltip-text">Expected annual inflation rate</span>
</span>
</label>
<input id="swpInflationRate" max="15" min="0" placeholder="6" step="0.1" type="number"/>
</div>
</div>
<button class="calculate-btn" onclick="calculateSWP()">Calculate SWP</button>
<div class="results-section" id="swpResultsSection">
<div class="results-grid">
<div class="result-card">
<h3>Investment</h3>
<div class="result-value" id="swpInvestment">₹0</div>
<div class="result-words" id="swpInvestmentWords"></div>
</div>
<div class="result-card">
<h3>First SWP</h3>
<div class="result-value" id="swpFirstSWP">₹0</div>
<div class="result-words" id="swpFirstSWPWords"></div>
</div>
<div class="result-card">
<h3>Last SWP (Inflated)</h3>
<div class="result-value" id="swpLastSWPInflated">₹0</div>
<div class="result-words" id="swpLastSWPInflatedWords"></div>
</div>
<div class="result-card">
<h3>Duration</h3>
<div class="result-value" id="swpDuration">0 Years</div>
</div>
<div class="result-card">
<h3>Rate of Return (Post-Tax)</h3>
<div class="result-value" id="swpRateOfReturn">0%</div>
</div>
<div class="result-card">
<h3>Total Withdrawal</h3>
<div class="result-value" id="swpTotalWithdrawal">₹0</div>
<div class="result-words" id="swpTotalWithdrawalWords"></div>
</div>
<div class="result-card">
<h3>Profit</h3>
<div class="result-value" id="swpProfit">₹0</div>
<div class="result-words" id="swpProfitWords"></div>
</div>
<div class="result-card">
<h3>Corpus Should Last For</h3>
<div class="result-value" id="swpCorpusShouldLastFor">0 Years</div>
</div>
<div class="result-card">
<h3>Cl. Balance</h3>
<div class="result-value" id="swpClosingBalance">₹0</div>
<div class="result-words" id="swpClosingBalanceWords"></div>
</div>
<div class="result-card">
<h3>Max Monthly Withdrawal</h3>
<div class="result-value" id="swpMaximumWithdrawal">₹0</div>
<div class="result-words" id="swpMaximumWithdrawalWords"></div>
</div>
</div>
</div>
<div class="permanent-disclaimer">
                        These calculations are based on standard formulas and may not reflect actual outcomes in real-life scenarios. They are provided for reference purposes only and should not be construed as professional advice. Users are encouraged to consult a qualified professional for guidance specific to their individual circumstances.
                    </div>
</div>
<div class="tab-content" id="emergencyFundTab">
<div class="input-section">
<div class="input-group">
<label for="currentDebt">
                                Current Debt Amount (<span id="emergencyFundCurrencySymbol">₹</span>)
                                <span class="info-tooltip">
<span class="tooltip-text">The total outstanding debt you currently have</span>
</span>
</label>
<input id="currentDebt" oninput="formatNumberInput(this); updateAmountInWords('currentDebt', 'currentDebtWords')" placeholder="2,00,000" type="text"/>
<div class="amount-in-words" id="currentDebtWords"></div>
</div>
<div class="input-group">
<label for="emergencyFundTargetMonths">
                                Emergency Fund Target (Months)
                                <span class="info-tooltip">
<span class="tooltip-text">Your target emergency fund size in months of living expenses (e.g., 6)</span>
</span>
</label>
<input id="emergencyFundTargetMonths" max="24" min="1" placeholder="6" type="number"/>
</div>
<div class="input-group">
<label for="monthlyDebtPayments">
                                Monthly Debt Payments (<span id="monthlyDebtPaymentsCurrencySymbol">₹</span>)
                                <span class="info-tooltip">
<span class="tooltip-text">The total amount you pay towards all your debts each month</span>
</span>
</label>
<input id="monthlyDebtPayments" oninput="formatNumberInput(this); updateAmountInWords('monthlyDebtPayments', 'monthlyDebtPaymentsWords')" placeholder="10,000" type="text"/>
<div class="amount-in-words" id="monthlyDebtPaymentsWords"></div>
</div>
<div class="input-group">
<label for="monthlySavings">
                                Monthly Savings (<span id="monthlySavingsCurrencySymbol">₹</span>)
                                <span class="info-tooltip">
<span class="tooltip-text">The amount you save each month (for both fund and debt repayment)</span>
</span>
</label>
<input id="monthlySavings" oninput="formatNumberInput(this); updateAmountInWords('monthlySavings', 'monthlySavingsWords')" placeholder="15,000" type="text"/>
<div class="amount-in-words" id="monthlySavingsWords"></div>
</div>
</div>
<button class="calculate-btn" onclick="calculateEmergencyFund()">Calculate Emergency Fund &amp; Debt Impact</button>
<div class="results-section" id="emergencyFundResultsSection">
<div class="results-grid">
<div class="result-card">
<h3>Total Emergency Fund Target</h3>
<div class="result-value" id="emergencyFundTargetValue">₹0</div>
<div class="result-words" id="emergencyFundTargetWords"></div>
</div>
<div class="result-card">
<h3>Months to Build Fund</h3>
<div class="result-value" id="monthsToBuildFund">0 Months</div>
</div>
<div class="result-card">
<h3>Total Savings Required</h3>
<div class="result-value" id="totalSavingsRequired">₹0</div>
<div class="result-words" id="totalSavingsRequiredWords"></div>
</div>
<div class="result-card">
<h3>Total Debt Payments</h3>
<div class="result-value" id="totalDebtPayments">₹0</div>
<div class="result-words" id="totalDebtPaymentsWords"></div>
</div>
</div>
</div>
<div class="permanent-disclaimer">
                        These calculations are based on standard formulas and may not reflect actual outcomes in real-life scenarios. They are provided for reference purposes only and should not be construed as professional advice. Users are encouraged to consult a qualified professional for guidance specific to their individual circumstances.
                    </div>
</div>
<div class="tab-content" id="strategyComparisonTab">
<div class="strategy-container">
<div class="strategy-column">
<h2 class="collapsible-h2">Strategy A</h2>
<div class="input-group">
<label for="initialInvestmentA">Initial Investment (<span id="strategyACurrencySymbol1">₹</span>)</label>
<input id="initialInvestmentA" oninput="formatNumberInput(this); displayAmountInWords('initialInvestmentA','initialInvestmentAWords')" placeholder="1,00,000" type="text"/>
<div class="amount-in-words" id="initialInvestmentAWords"></div>
</div>
<div class="input-group">
<label for="recurringAmountA">Recurring Investment (<span id="strategyACurrencySymbol2">₹</span>)</label>
<input id="recurringAmountA" oninput="formatNumberInput(this); displayAmountInWords('recurringAmountA','recurringAmountAWords')" placeholder="10,000" type="text"/>
<div class="amount-in-words" id="recurringAmountAWords"></div>
</div>
<div class="input-group">
<label for="investmentDurationA">Investment Duration (Years)</label>
<input id="investmentDurationA" placeholder="10" type="number"/>
</div>
<div class="input-group">
<label for="holdingPeriodA">Total Holding Period (Years)</label>
<input id="holdingPeriodA" placeholder="15" type="number"/>
</div>
<div class="input-group">
<label for="annualReturnA">Annual Return (%)</label>
<input id="annualReturnA" placeholder="12" type="number"/>
</div>
<div class="input-group">
<label for="taxRateA">Tax Rate (%)</label>
<input id="taxRateA" placeholder="10" type="number"/>
</div>
</div>
<div class="strategy-column">
<h2 class="collapsible-h2">Strategy B</h2>
<div class="input-group">
<label for="initialInvestmentB">Initial Investment (<span id="strategyBCurrencySymbol1">₹</span>)</label>
<input id="initialInvestmentB" oninput="formatNumberInput(this); displayAmountInWords('initialInvestmentB','initialInvestmentBWords')" placeholder="1,00,000" type="text"/>
<div class="amount-in-words" id="initialInvestmentBWords"></div>
</div>
<div class="input-group">
<label for="recurringAmountB">Recurring Investment (<span id="strategyBCurrencySymbol2">₹</span>)</label>
<input id="recurringAmountB" oninput="formatNumberInput(this); displayAmountInWords('recurringAmountB','recurringAmountBWords')" placeholder="5,000" type="text"/>
<div class="amount-in-words" id="recurringAmountBWords"></div>
</div>
<div class="input-group">
<label for="investmentDurationB">Investment Duration (Years)</label>
<input id="investmentDurationB" placeholder="15" type="number"/>
</div>
<div class="input-group">
<label for="holdingPeriodB">Total Holding Period (Years)</label>
<input id="holdingPeriodB" placeholder="15" type="number"/>
</div>
<div class="input-group">
<label for="annualReturnB">Annual Return (%)</label>
<input id="annualReturnB" placeholder="10" type="number"/>
</div>
<div class="input-group">
<label for="taxRateB">Tax Rate (%)</label>
<input id="taxRateB" placeholder="10" type="number"/>
</div>
</div>
</div>
<div class="input-group" style="grid-column: span 2;">
<label for="comparisonInflationRate">Common Inflation Rate (%)</label>
<input id="comparisonInflationRate" placeholder="6" type="number"/>
</div>
<button class="calculate-btn" id="compareBtn" onclick="compareStrategies()">Compare Strategies</button>
<div id="comparisonSummary" style="margin-top:10px; margin-bottom:10px; text-align:center; padding:16px; background:#fff; font-size:1.15em; font-weight:600; color:#333; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.1); display:none;"></div>
<div class="results-section" id="strategyComparisonResultsSection" style="display:none; margin-top:10px;">
<div class="comparison-output-container">
<div class="comparison-results-wrapper">
<h3>Comparison Results</h3>
<table class="comparison-results-table" id="comparisonTable" style="width:100%; border-collapse:collapse; background:#fff; border-radius:10px; overflow:hidden;">
<thead style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:#fff;">
<tr>
<th style="padding:10px; text-align:left;">Metric</th>
<th style="padding:10px; text-align:center;">Strategy A</th>
<th style="padding:10px; text-align:center;">Strategy B</th>
</tr>
</thead>
<tbody>
<tr>
<td class="metric-label">Future Value (Nominal)</td>
<td class="result-value-cell" id="comparisonFutureValueNominalA">₹0</td>
<td class="result-value-cell" id="comparisonFutureValueNominalB">₹0</td>
</tr>
<tr>
<td class="metric-label">Future Value (Real)</td>
<td class="result-value-cell" id="comparisonFutureValueRealA">₹0</td>
<td class="result-value-cell" id="comparisonFutureValueRealB">₹0</td>
</tr>
<tr>
<td class="metric-label">Total Contributions</td>
<td class="result-value-cell" id="comparisonTotalContributionsA">₹0</td>
<td class="result-value-cell" id="comparisonTotalContributionsB">₹0</td>
</tr>
<tr>
<td class="metric-label">Total Gains</td>
<td class="result-value-cell" id="comparisonTotalGainsA">₹0</td>
<td class="result-value-cell" id="comparisonTotalGainsB">₹0</td>
</tr>
<tr>
<td class="metric-label">Final Value (After Tax)</td>
<td class="result-value-cell" id="comparisonFinalValueA">₹0</td>
<td class="result-value-cell" id="comparisonFinalValueB">₹0</td>
</tr>
</tbody>
</table>
<div class="chart-container" style="margin-top:20px;"><canvas id="comparisonChart"></canvas></div>

</div>
</div>
</div>
<div class="permanent-disclaimer">
                        These calculations are based on standard formulas and may not reflect actual outcomes in real-life scenarios. They are provided for reference purposes only and should not be construed as professional advice. Users are encouraged to consult a qualified professional for guidance specific to their individual circumstances.
                    </div>
</div>
</div>
</div>
</div>
<script>
        let selectedFrequency = 'monthly';
        let selectedCurrency = 'INR';
        let currencySymbol = '₹';
        let comparisonChartInstance = null; // To hold the chart instance

        // Function to capitalize the first letter of each word
        function toTitleCase(str) {
            return str.replace(/\w\S*/g, function(txt){
                return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
            });
        }

        // Currency configuration
        const currencyConfig = {
            'INR': {
                symbol: '₹',
                locale: 'en-IN',
                defaultInitial: '100000.00',
                defaultRecurring: '10000.00',
                defaultReturn: '12',
                defaultTax: '10',
                defaultInflation: '6',
                defaultTargetAmount: '10000000.00',
                defaultTargetInitial: '0.00',
                defaultTargetDuration: '20',
                defaultSWPInitial: '5000000.00',
                defaultSWPDeferral: '0',
                defaultSWPWithdrawalAmount: '25000.00',
                defaultSWPDuration: '15',
                defaultCurrentDebt: '200000.00',
                defaultEmergencyFundTargetMonths: '6',
                defaultMonthlyDebtPayments: '10000.00',
                defaultMonthlySavings: '15000.00'
            },
            'USD': {
                symbol: '$',
                locale: 'en-US',
                defaultInitial: '10000.00',
                defaultRecurring: '1000.00',
                defaultReturn: '8',
                defaultTax: '20',
                defaultInflation: '3',
                defaultTargetAmount: '1000000.00',
                defaultTargetInitial: '0.00',
                defaultTargetDuration: '25',
                defaultSWPInitial: '500000.00',
                defaultSWPDeferral: '0',
                defaultSWPWithdrawalAmount: '2000.00',
                defaultSWPDuration: '20',
                defaultCurrentDebt: '20000.00',
                defaultEmergencyFundTargetMonths: '6',
                defaultMonthlyDebtPayments: '1000.00',
                defaultMonthlySavings: '1500.00'
            },
            'EUR': {
                symbol: '€',
                locale: 'en-IE',
                defaultInitial: '10000.00',
                defaultRecurring: '1000.00',
                defaultReturn: '7',
                defaultTax: '25',
                defaultInflation: '2',
                defaultTargetAmount: '1000000.00',
                defaultTargetInitial: '0.00',
                defaultTargetDuration: '25',
                defaultSWPInitial: '500000.00',
                defaultSWPDeferral: '0',
                defaultSWPWithdrawalAmount: '2000.00',
                defaultSWPDuration: '20',
                defaultCurrentDebt: '20000.00',
                defaultEmergencyFundTargetMonths: '6',
                defaultMonthlyDebtPayments: '1000.00',
                defaultMonthlySavings: '1500.00'
            },
            'JPY': {
                symbol: '¥',
                locale: 'ja-JP',
                defaultInitial: '1000000.00',
                defaultRecurring: '100000.00',
                defaultReturn: '5',
                defaultTax: '20',
                defaultInflation: '1',
                defaultTargetAmount: '100000000.00',
                defaultTargetInitial: '0.00',
                defaultTargetDuration: '30',
                defaultSWPInitial: '50000000.00',
                defaultSWPWithdrawalAmount: '200000.00',
                defaultSWPDuration: '25',
                defaultCurrentDebt: '2000000.00',
                defaultEmergencyFundTargetMonths: '6',
                defaultMonthlyDebtPayments: '100000.00',
                defaultMonthlySavings: '150000.00'
            }
        };

        // Function to switch between tabs
        function showTab(tabId) {
            // Destroy chart if it exists when switching tabs
            if (comparisonChartInstance) {
                comparisonChartInstance.destroy();
                comparisonChartInstance = null;
            }

            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            // Deactivate all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            // Show the selected tab content
            document.getElementById(tabId).classList.add('active');
            // Activate the clicked tab button by finding the one with the correct onclick attribute
            document.querySelector(`.tab-button[onclick*="${tabId}"]`).classList.add('active');
            // Hide all results sections when switching tabs
            document.getElementById('futureValueResultsSection').style.display = 'none';
            document.getElementById('targetInvestmentResultsSection').style.display = 'none';
            document.getElementById('swpResultsSection').style.display = 'none';
            document.getElementById('emergencyFundResultsSection').style.display = 'none';
            document.getElementById('strategyComparisonResultsSection').style.display = 'none';
            // Re-initialize values for the newly active tab
            initializeTabValues(tabId);
        }

        // Function to initialize input values for a given tab
        function initializeTabValues(tabId) {
            const config = currencyConfig[selectedCurrency];
            // Common currency symbol update
            updateCurrencySymbols();
            // Use a temporary parser to get a clean number for placeholder values
            const parseAndFormat = (val) => {
                const cleanVal = String(val).replace(/[^0-9.]/g, '');
                const num = parseFloat(cleanVal);
                if (isNaN(num)) return '';
                // Always format with 2 decimal places for initial display in inputs
                return new Intl.NumberFormat(config.locale, { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(num);
            };

            if (tabId === 'futureValueTab') {
                document.getElementById('initialInvestment').value = parseAndFormat(config.defaultInitial);
                document.getElementById('recurringAmount').value = parseAndFormat(config.defaultRecurring);
                document.getElementById('investmentDuration').value = document.getElementById('investmentDuration').placeholder;
                document.getElementById('holdingPeriod').value = document.getElementById('holdingPeriod').placeholder;
                document.getElementById('annualReturn').value = config.defaultReturn;
                document.getElementById('taxRate').value = config.defaultTax;
                document.getElementById('inflationRate').value = config.defaultInflation;
                updateAmountInWords('initialInvestment', 'initialWords');
                updateAmountInWords('recurringAmount', 'recurringWords');
            } else if (tabId === 'targetInvestmentTab') {
                document.getElementById('targetAmount').value = parseAndFormat(config.defaultTargetAmount);
                document.getElementById('targetInitialInvestment').value = parseAndFormat(config.defaultTargetInitial);
                document.getElementById('targetDuration').value = document.getElementById('targetDuration').placeholder;
                document.getElementById('targetAnnualReturn').value = config.defaultReturn;
                document.getElementById('targetTaxRate').value = config.defaultTax;
                document.getElementById('targetInflationRate').value = config.defaultInflation;
                updateAmountInWords('targetAmount', 'targetWords');
                updateAmountInWords('targetInitialInvestment', 'targetInitialWords');
            } else if (tabId === 'swpCalculatorTab') {
                document.getElementById('swpInitialAmount').value = parseAndFormat(config.defaultSWPInitial);
                document.getElementById('deferWithdrawalFor').value = config.defaultSWPDeferral;
                document.getElementById('monthlyWithdrawalAmount').value = parseAndFormat(config.defaultSWPWithdrawalAmount);
                document.getElementById('withdrawalDuration').value = config.defaultSWPDuration;
                document.getElementById('swpAnnualReturn').value = config.defaultReturn;
                document.getElementById('swpTaxRate').value = config.defaultTax;
                document.getElementById('swpInflationRate').value = config.defaultInflation;
                updateAmountInWords('swpInitialAmount', 'swpInitialWords');
                updateAmountInWords('monthlyWithdrawalAmount', 'swpWithdrawalWords');
            } else if (tabId === 'emergencyFundTab') {
                document.getElementById('currentDebt').value = parseAndFormat(config.defaultCurrentDebt);
                document.getElementById('emergencyFundTargetMonths').value = config.defaultEmergencyFundTargetMonths;
                document.getElementById('monthlyDebtPayments').value = parseAndFormat(config.defaultMonthlyDebtPayments);
                document.getElementById('monthlySavings').value = parseAndFormat(config.defaultMonthlySavings);
                updateAmountInWords('currentDebt', 'currentDebtWords');
                updateAmountInWords('monthlyDebtPayments', 'monthlyDebtPaymentsWords');
                updateAmountInWords('monthlySavings', 'monthlySavingsWords');
            } else if (tabId === 'strategyComparisonTab') {
                // Initialize Strategy A
                document.getElementById('initialInvestmentA').value = parseAndFormat(config.defaultInitial);
                document.getElementById('recurringAmountA').value = parseAndFormat(config.defaultRecurring);
                document.getElementById('investmentDurationA').value = '10';
                document.getElementById('holdingPeriodA').value = '15';
                document.getElementById('annualReturnA').value = config.defaultReturn;
                document.getElementById('taxRateA').value = config.defaultTax;
                
                // Initialize Strategy B
                document.getElementById('initialInvestmentB').value = parseAndFormat(config.defaultInitial);
                document.getElementById('recurringAmountB').value = parseAndFormat(parseFloat(config.defaultRecurring) / 2); // Example: half recurring
                document.getElementById('investmentDurationB').value = '15';
                document.getElementById('holdingPeriodB').value = '15';
                document.getElementById('annualReturnB').value = parseFloat(config.defaultReturn) - 2; // Example: lower return
                document.getElementById('taxRateB').value = config.defaultTax;
                
                // Common Inflation
                document.getElementById('comparisonInflationRate').value = config.defaultInflation;
            }
        }

        // Function to update currency symbols across all inputs
        function updateCurrencySymbols() {
            document.querySelectorAll('[id$="CurrencySymbol"], [id^="strategyACurrencySymbol"], [id^="strategyBCurrencySymbol"]').forEach(element => {
                element.textContent = currencySymbol;
            });
        }

        // Format number input with commas and limit decimals
        function formatNumberInput(input) {
            let value = input.value.replace(/[^0-9.]/g, '');
            let parts = value.split('.');
            let integerPart = parts[0];
            let decimalPart = parts[1] || '';
            const config = currencyConfig[selectedCurrency];
            if (!isNaN(parseFloat(integerPart))) {
                integerPart = new Intl.NumberFormat(config.locale, { minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(parseFloat(integerPart));
            } else {
                integerPart = '';
            }
            if (decimalPart.length > 2) {
                decimalPart = decimalPart.substring(0, 2);
            }
            input.value = integerPart + (parts.length > 1 ? '.' + decimalPart : '');
        }

        // Convert number to words based on currency
        function numberToWords(amount) {
            const isNegative = amount < 0;
            const absAmount = Math.abs(amount);
            const num = Math.floor(absAmount);
            const cents = Math.round((absAmount * 100) % 100);
            let mainWords = '';
            let mainCurrencyName = '';
            let fractionalCurrencyName = '';

            if (selectedCurrency === 'INR') {
                mainWords = convertToIndianWords(num);
                mainCurrencyName = 'Rupees';
                fractionalCurrencyName = 'Paise';
            } else if (selectedCurrency === 'USD') {
                mainWords = convertToWesternWords(num);
                mainCurrencyName = 'Dollars';
                fractionalCurrencyName = 'Cents';
            } else if (selectedCurrency === 'EUR') {
                mainWords = convertToWesternWords(num);
                mainCurrencyName = 'Euros';
                fractionalCurrencyName = 'Cents';
            } else if (selectedCurrency === 'JPY') {
                mainWords = convertToJapaneseWords(num);
                mainCurrencyName = 'Yen';
                fractionalCurrencyName = 'Sen'; // Note: 'Sen' is rarely used now, but included for completeness.
            }
            mainCurrencyName = num === 1 ? mainCurrencyName.slice(0, -1) : mainCurrencyName;
            fractionalCurrencyName = cents === 1 ? fractionalCurrencyName.slice(0, -1) : fractionalCurrencyName;
            let result = `${toTitleCase(mainWords)} ${toTitleCase(mainCurrencyName)}`;
            if (cents > 0) {
                const fractionalWords = selectedCurrency === 'INR' ? convertToIndianWords(cents) : (selectedCurrency === 'JPY' ? convertToJapaneseWords(cents) : convertToWesternWords(cents));
                result += ` And ${toTitleCase(fractionalWords)} ${toTitleCase(fractionalCurrencyName)}`;
            }
            return isNegative ? `Negative ${result}` : result;
        }

        function convertToIndianWords(num) {
            if (num === 0) return 'zero';
            const a = ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
            const b = ['', '', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];
            let n = ('000000000' + num).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);
            if (!n) return '';
            let str = '';
            str += (n[1] !== '00') ? (a[Number(n[1])] || b[n[1][0]] + ' ' + a[n[1][1]]) + ' crore ' : '';
            str += (n[2] !== '00') ? (a[Number(n[2])] || b[n[2][0]] + ' ' + a[n[2][1]]) + ' lakh ' : '';
            str += (n[3] !== '00') ? (a[Number(n[3])] || b[n[3][0]] + ' ' + a[n[3][1]]) + ' thousand ' : '';
            str += (n[4] !== '0') ? (a[Number(n[4])] || b[n[4][0]] + ' ' + a[n[4][1]]) + ' hundred ' : '';
            str += (n[5] !== '00') ? ((str !== '') ? 'and ' : '') + (a[Number(n[5])] || b[n[5][0]] + ' ' + a[n[5][1]]) : '';
            return str.trim();
        }

        
        function convertToWesternWords(num) {
            if (num === 0) return 'zero';
            const a = ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
            const b = ['', '', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];
            const g = ['', 'thousand', 'million', 'billion', 'trillion'];

            function chunkToWords(n) {
                let str = '';
                const hundred = Math.floor(n / 100);
                const rest = n % 100;
                if (hundred > 0) {
                    str += a[hundred] + ' hundred';
                    if (rest > 0) str += ' and ';
                }
                if (rest > 0) {
                    if (rest < 20) str += a[rest];
                    else {
                        const tens = Math.floor(rest / 10);
                        const ones = rest % 10;
                        str += b[tens];
                        if (ones > 0) str += '-' + a[ones];
                    }
                }
                return str.trim();
            }

            let result = '';
            let groupIndex = 0;
            while (num > 0) {
                const chunk = num % 1000;
                if (chunk > 0) {
                    const words = chunkToWords(chunk);
                    result = words + (g[groupIndex] ? ' ' + g[groupIndex] + ' ' : ' ') + result;
                }
                num = Math.floor(num / 1000);
                groupIndex++;
            }
            return result.trim();
        }

        function convertToJapaneseWords(num) {
            const units = ['', 'man', 'oku', 'chou', 'kei', 'gai', 'jo'];
            const digits = ['', 'ichi', 'ni', 'san', 'yon', 'go', 'roku', 'nana', 'hachi', 'kyuu'];
            if (num === 0) return 'rei';
            let str = '';
            let i = 0;
            while (num > 0) {
                let n = num % 10000;
                if (n > 0) {
                    let temp = '';
                    if (n >= 1000) {
                        temp += (n >= 2000 ? digits[Math.floor(n / 1000)] : '') + 'sen';
                        n %= 1000;
                    }
                    if (n >= 100) {
                        temp += (n >= 200 ? digits[Math.floor(n / 100)] : '') + 'hyaku';
                        n %= 100;
                    }
                    if (n >= 10) {
                        temp += (n >= 20 ? digits[Math.floor(n / 10)] : '') + 'juu';
                        n %= 10;
                    }
                    if (n > 0) temp += digits[n];
                    str = temp + units[i] + str;
                }
                num = Math.floor(num / 10000);
                i++;
            }
            return str;
        }

        function updateAmountInWords(inputId, wordsId) {
            const input = document.getElementById(inputId);
            const wordsDiv = document.getElementById(wordsId);
            const cleanValue = input.value.replace(/[^0-9.]/g, '');
            const numberValue = parseFloat(cleanValue);
            if (!isNaN(numberValue)) {
                wordsDiv.textContent = numberToWords(numberValue);
            } else {
                wordsDiv.textContent = '';
            }
        }

        function parseAndCleanNumber(inputElementId) {
            const value = document.getElementById(inputElementId).value;
            return parseFloat(value.replace(/[^0-9.]/g, '')) || 0;
        }

        function formatCurrency(amount) {
            const config = currencyConfig[selectedCurrency];
            return new Intl.NumberFormat(config.locale, {
                style: 'currency',
                currency: selectedCurrency,
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }

        // Future Value Calculation - ORIGINAL
        function calculateInvestment() {
            const initialInvestment = parseAndCleanNumber('initialInvestment');
            const recurringAmount = parseAndCleanNumber('recurringAmount');
            const investmentDuration = parseAndCleanNumber('investmentDuration');
            const holdingPeriod = parseAndCleanNumber('holdingPeriod');
            const annualReturn = parseAndCleanNumber('annualReturn') / 100;
            const taxRate = parseAndCleanNumber('taxRate') / 100;
            const inflationRate = parseAndCleanNumber('inflationRate') / 100;

            if (holdingPeriod < investmentDuration) {
                document.getElementById('holdingPeriodError').style.display = 'block';
                return;
            } else {
                document.getElementById('holdingPeriodError').style.display = 'none';
            }

            const monthlyReturn = annualReturn / 12;
            const recurringPeriod = selectedFrequency === 'monthly' ? investmentDuration * 12 : investmentDuration;
            const remainingPeriod = holdingPeriod - investmentDuration;
            const recurringMultiplier = selectedFrequency === 'monthly' ? 12 : 1;
            const annualContribution = recurringAmount * recurringMultiplier;

            let futureValue = 0;
            let currentAmount = initialInvestment;

            // Phase 1: Contribution Period
            if (selectedFrequency === 'monthly') {
                let fvLump = initialInvestment * Math.pow(1 + annualReturn, investmentDuration);
                let fvRecurring = 0;
                if (monthlyReturn > 0) {
                    fvRecurring = recurringAmount * (Math.pow(1 + monthlyReturn, recurringPeriod) - 1) / monthlyReturn;
                } else {
                    fvRecurring = recurringAmount * recurringPeriod;
                }
                currentAmount = fvLump + fvRecurring;
            } else { // Yearly
                const fv_lump = initialInvestment * Math.pow(1 + annualReturn, investmentDuration);
                const fv_recurring = recurringAmount * ((Math.pow(1 + annualReturn, investmentDuration) - 1) / annualReturn);
                currentAmount = fv_lump + fv_recurring;
            }


            // Phase 2: Holding Period
            if (remainingPeriod > 0) {
                currentAmount = currentAmount * Math.pow(1 + annualReturn, remainingPeriod);
            }
            futureValue = currentAmount;

            const totalContributions = initialInvestment + annualContribution * investmentDuration;
            const totalGains = futureValue - totalContributions;
            const postTaxGain = totalGains > 0 ? totalGains * (1 - taxRate) : 0;
            const futureValuePostTax = totalContributions + postTaxGain;
            const realFutureValue = futureValuePostTax / Math.pow(1 + inflationRate, holdingPeriod);

            document.getElementById('futureValueNominal').textContent = formatCurrency(futureValue);
            document.getElementById('futureValueReal').textContent = formatCurrency(realFutureValue);
            document.getElementById('totalContributions').textContent = formatCurrency(totalContributions);
            document.getElementById('totalGains').textContent = formatCurrency(totalGains);
            document.getElementById('breakdownInitial').textContent = formatCurrency(initialInvestment);
            document.getElementById('breakdownRecurring').textContent = formatCurrency(annualContribution * investmentDuration);
            document.getElementById('breakdownGrossGains').textContent = formatCurrency(totalGains);
            document.getElementById('breakdownTaxes').textContent = formatCurrency(totalGains > 0 ? totalGains * taxRate : 0);
            document.getElementById('breakdownNetGains').textContent = formatCurrency(postTaxGain);
            document.getElementById('breakdownFinalValue').textContent = formatCurrency(futureValuePostTax);
            document.getElementById('breakdownRealValue').textContent = formatCurrency(realFutureValue);
            document.getElementById('futureValueNominalWords').textContent = numberToWords(futureValue);
            document.getElementById('futureValueRealWords').textContent = numberToWords(realFutureValue);
            document.getElementById('totalContributionsWords').textContent = numberToWords(totalContributions);
            document.getElementById('totalGainsWords').textContent = numberToWords(totalGains);
            document.getElementById('breakdownInitialWords').textContent = numberToWords(initialInvestment);
            document.getElementById('breakdownRecurringWords').textContent = numberToWords(annualContribution * investmentDuration);
            document.getElementById('breakdownGrossGainsWords').textContent = numberToWords(totalGains);
            document.getElementById('breakdownTaxesWords').textContent = numberToWords(totalGains > 0 ? totalGains * taxRate : 0);
            document.getElementById('breakdownNetGainsWords').textContent = numberToWords(postTaxGain);
            document.getElementById('breakdownFinalValueWords').textContent = numberToWords(futureValuePostTax);
            document.getElementById('breakdownRealValueWords').textContent = numberToWords(realFutureValue);
            document.getElementById('futureValueResultsSection').style.display = 'block';
        }


        // Target Investment Calculation - ORIGINAL
        function calculateTargetInvestment() {
            const targetAmount = parseAndCleanNumber('targetAmount');
            const targetInitialInvestment = parseAndCleanNumber('targetInitialInvestment');
            const targetDuration = parseAndCleanNumber('targetDuration');
            const targetAnnualReturn = parseAndCleanNumber('targetAnnualReturn') / 100;
            const targetTaxRate = parseAndCleanNumber('targetTaxRate') / 100;
            const targetInflationRate = parseAndCleanNumber('targetInflationRate') / 100;
            const monthlyReturn = targetAnnualReturn / 12;
            const monthlyInflation = targetInflationRate / 12;
            const numberOfMonths = targetDuration * 12;

            const futureValueRequired = targetAmount * Math.pow(1 + targetInflationRate, targetDuration);
            const futureValuePostTax = futureValueRequired / (1 - targetTaxRate);
            const futureValueFromInitial = targetInitialInvestment * Math.pow(1 + monthlyReturn, numberOfMonths);
            const remainingTarget = futureValuePostTax - futureValueFromInitial;
            const monthlyContribution = remainingTarget / ((Math.pow(1 + monthlyReturn, numberOfMonths) - 1) / monthlyReturn);
            const yearlyContribution = monthlyContribution * 12;
            const totalContributions = targetInitialInvestment + monthlyContribution * numberOfMonths;
            const totalGains = futureValuePostTax - totalContributions;

            document.getElementById('requiredMonthlyContribution').textContent = formatCurrency(monthlyContribution);
            document.getElementById('requiredYearlyContribution').textContent = formatCurrency(yearlyContribution);
            document.getElementById('targetTotalContributions').textContent = formatCurrency(totalContributions);
            document.getElementById('targetTotalGains').textContent = formatCurrency(totalGains);
            document.getElementById('breakdownTargetAmount').textContent = formatCurrency(targetAmount);
            document.getElementById('breakdownTargetInitial').textContent = formatCurrency(targetInitialInvestment);
            document.getElementById('breakdownTargetRecurring').textContent = formatCurrency(totalContributions - targetInitialInvestment);
            document.getElementById('breakdownTargetGrossGains').textContent = formatCurrency(totalGains / (1 - targetTaxRate));
            document.getElementById('breakdownTargetTaxes').textContent = formatCurrency(totalGains * (1 - targetTaxRate));
            document.getElementById('breakdownTargetNetGains').textContent = formatCurrency(totalGains);
            document.getElementById('requiredMonthlyContributionWords').textContent = numberToWords(monthlyContribution);
            document.getElementById('requiredYearlyContributionWords').textContent = numberToWords(yearlyContribution);
            document.getElementById('targetTotalContributionsWords').textContent = numberToWords(totalContributions);
            document.getElementById('targetTotalGainsWords').textContent = numberToWords(totalGains);
            document.getElementById('breakdownTargetAmountWords').textContent = numberToWords(targetAmount);
            document.getElementById('breakdownTargetInitialWords').textContent = numberToWords(targetInitialInvestment);
            document.getElementById('breakdownTargetRecurringWords').textContent = numberToWords(totalContributions - targetInitialInvestment);
            document.getElementById('breakdownTargetGrossGainsWords').textContent = numberToWords(totalGains / (1 - targetTaxRate));
            document.getElementById('breakdownTargetTaxesWords').textContent = numberToWords(totalGains * (1 - targetTaxRate));
            document.getElementById('breakdownTargetNetGainsWords').textContent = numberToWords(totalGains);
            document.getElementById('targetInvestmentResultsSection').style.display = 'block';
        }

        // SWP Calculation - ORIGINAL
        function calculateSWP() {
            const initialInvestment = parseAndCleanNumber('swpInitialAmount');
            const deferralYears = parseAndCleanNumber('deferWithdrawalFor');
            const withdrawalAmount = parseAndCleanNumber('monthlyWithdrawalAmount');
            const withdrawalDuration = parseAndCleanNumber('withdrawalDuration');
            const annualReturn = parseAndCleanNumber('swpAnnualReturn') / 100;
            const taxRate = parseAndCleanNumber('swpTaxRate') / 100;
            const inflationRate = parseAndCleanNumber('swpInflationRate') / 100;

            const monthlyReturn = annualReturn / 12;
            const monthlyTaxRate = taxRate / 12;

            let currentCorpus = initialInvestment;
            // Deferral period calculation
            for (let i = 0; i < deferralYears * 12; i++) {
                currentCorpus *= (1 + monthlyReturn);
            }

            let totalWithdrawal = 0;
            let totalProfit = 0;
            let finalCorpus = currentCorpus;
            let withdrawalPeriodMonths = 0;

            // Withdrawal period calculation
            for (let i = 0; i < withdrawalDuration * 12; i++) {
                if (finalCorpus <= 0) break;
                const monthlyProfit = finalCorpus * monthlyReturn;
                const postTaxProfit = monthlyProfit * (1 - monthlyTaxRate);
                const taxableWithdrawal = withdrawalAmount - postTaxProfit;

                if (taxableWithdrawal < 0) {
                    finalCorpus += postTaxProfit - withdrawalAmount;
                    totalProfit += postTaxProfit;
                } else {
                    finalCorpus -= withdrawalAmount;
                    totalProfit += postTaxProfit;
                }

                totalWithdrawal += withdrawalAmount;
                withdrawalPeriodMonths++;
            }

            const totalWithdrawalInWords = numberToWords(totalWithdrawal);
            const totalProfitInWords = numberToWords(totalProfit);
            const closingBalance = finalCorpus > 0 ? finalCorpus : 0;
            const closingBalanceInWords = numberToWords(closingBalance);
            const totalDurationYears = Math.floor(withdrawalPeriodMonths / 12);
            const totalDurationMonths = withdrawalPeriodMonths % 12;
            const withdrawalRate = (withdrawalAmount * 12) / initialInvestment * 100;

            document.getElementById('swpInvestment').textContent = formatCurrency(initialInvestment);
            document.getElementById('swpInvestmentWords').textContent = numberToWords(initialInvestment);
            document.getElementById('swpFirstSWP').textContent = formatCurrency(withdrawalAmount);
            document.getElementById('swpFirstSWPWords').textContent = numberToWords(withdrawalAmount);
            document.getElementById('swpTotalWithdrawal').textContent = formatCurrency(totalWithdrawal);
            document.getElementById('swpTotalWithdrawalWords').textContent = numberToWords(totalWithdrawal);
            document.getElementById('swpProfit').textContent = formatCurrency(totalProfit);
            document.getElementById('swpProfitWords').textContent = numberToWords(totalProfit);
            document.getElementById('swpCorpusShouldLastFor').textContent = `${totalDurationYears} Years ${totalDurationMonths} Months`;
            document.getElementById('swpClosingBalance').textContent = formatCurrency(closingBalance);
            document.getElementById('swpClosingBalanceWords').textContent = numberToWords(closingBalance);
            document.getElementById('swpResultsSection').style.display = 'block';

            // Resetting max monthly withdrawal value for now as it needs a more complex calculation
            document.getElementById('swpMaximumWithdrawal').textContent = 'N/A';
            document.getElementById('swpMaximumWithdrawalWords').textContent = '';
        }

        // Emergency Fund & Debt Impact Calculation
        function calculateEmergencyFund() {
            const currentDebt = parseAndCleanNumber('currentDebt');
            const emergencyFundTargetMonths = parseAndCleanNumber('emergencyFundTargetMonths');
            const monthlyDebtPayments = parseAndCleanNumber('monthlyDebtPayments');
            const monthlySavings = parseAndCleanNumber('monthlySavings');

            const emergencyFundTargetValue = (monthlyDebtPayments + monthlySavings) * emergencyFundTargetMonths;
            const netMonthlyContribution = monthlySavings - monthlyDebtPayments;

            let monthsToBuildFund = 0;
            if (netMonthlyContribution > 0) {
                monthsToBuildFund = Math.ceil(emergencyFundTargetValue / netMonthlyContribution);
            } else {
                monthsToBuildFund = Infinity;
            }

            const totalSavingsRequired = emergencyFundTargetValue;
            const totalDebtPayments = monthlyDebtPayments * monthsToBuildFund;

            document.getElementById('emergencyFundTargetValue').textContent = formatCurrency(emergencyFundTargetValue);
            document.getElementById('emergencyFundTargetWords').textContent = numberToWords(emergencyFundTargetValue);
            document.getElementById('monthsToBuildFund').textContent = monthsToBuildFund === Infinity ? 'Cannot Build Fund' : `${monthsToBuildFund} Months`;
            document.getElementById('totalSavingsRequired').textContent = formatCurrency(totalSavingsRequired);
            document.getElementById('totalSavingsRequiredWords').textContent = numberToWords(totalSavingsRequired);
            document.getElementById('totalDebtPayments').textContent = formatCurrency(totalDebtPayments);
            document.getElementById('totalDebtPaymentsWords').textContent = numberToWords(totalDebtPayments);

            document.getElementById('emergencyFundResultsSection').style.display = 'block';
        }
        
        // Strategy Comparison Calculation
        

        function drawComparisonChart(resultsA, resultsB) {
            if (comparisonChartInstance) {
                comparisonChartInstance.destroy();
            }

            const ctx = document.getElementById('comparisonChart').getContext('2d');
            const labels = ['Future Value (Nominal)', 'Total Contributions', 'Total Gains', 'Final Value (After Tax)'];

            comparisonChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Strategy A',
                            data: [resultsA.futureValueNominal, resultsA.totalContributions, resultsA.totalGains, resultsA.finalValue],
                            backgroundColor: 'rgba(102, 126, 234, 0.7)',
                            borderColor: 'rgba(102, 126, 234, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Strategy B',
                            data: [resultsB.futureValueNominal, resultsB.totalContributions, resultsB.totalGains, resultsB.finalValue],
                            backgroundColor: 'rgba(118, 75, 162, 0.7)',
                            borderColor: 'rgba(118, 75, 162, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value, index, values) {
                                    return formatCurrency(value).replace(/\.00$/, ''); // Format as currency and remove trailing zeros
                                }
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Strategy Performance Comparison',
                            font: {
                                size: 16
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += formatCurrency(context.parsed.y);
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }


        // Event Listeners for Currency Change
        document.getElementById('globalCurrencySelect').addEventListener('change', function() {
            selectedCurrency = this.value;
            currencySymbol = currencyConfig[selectedCurrency].symbol;
            // Get the ID of the currently active tab
            const activeTabId = document.querySelector('.tab-content.active').id;
            initializeTabValues(activeTabId);
        });

        // Event listener for recurring frequency
        document.querySelectorAll('.frequency-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.frequency-option').forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
                selectedFrequency = this.dataset.frequency;
            });
        });

        // Set initial values on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Set initial values for the default active tab (Future Value)
            initializeTabValues('futureValueTab');
            // Show the default tab
            showTab('futureValueTab');

            // Set initial value for the dropdown based on selectedCurrency
            document.getElementById('globalCurrencySelect').value = selectedCurrency;
        });

        // Add enter key support for calculation on active tab
        document.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                const activeTabId = document.querySelector('.tab-content.active').id;
                if (activeTabId === 'futureValueTab') {
                    calculateInvestment();
                } else if (activeTabId === 'targetInvestmentTab') {
                    calculateTargetInvestment();
                } else if (activeTabId === 'swpCalculatorTab') {
                    calculateSWP();
                } else if (activeTabId === 'emergencyFundTab') {
                    calculateEmergencyFund();
                } else if (activeTabId === 'strategyComparisonTab') {
                    compareStrategies();
                }
            }
        });
    
// ===== Mobile Slide-Over Menu Script =====
function toggleMenu() {
    const nav = document.querySelector('.tab-nav');
    const isOpen = nav.classList.toggle('open');
    if (isOpen) {
        document.body.classList.add('menu-open');
    } else {
        document.body.classList.remove('menu-open');
    }
}

// Close menu when clicking outside or selecting a tab
document.addEventListener('click', function(e) {
    const nav = document.querySelector('.tab-nav');
    const toggleBtn = document.querySelector('.menu-toggle');
    if (nav.classList.contains('open') &&
        !nav.contains(e.target) &&
        !toggleBtn.contains(e.target)) {
        nav.classList.remove('open');
        document.body.classList.remove('menu-open');
    }
});

// Auto-close on tab click (for mobile/iPad)
document.querySelectorAll('.tab-button').forEach(btn => {
    btn.addEventListener('click', () => {
        const nav = document.querySelector('.tab-nav');
        if (window.innerWidth <= 1024) {
            nav.classList.remove('open');
            document.body.classList.remove('menu-open');
        }
    });
});
// ===== End Mobile Slide-Over Menu Script =====


        // Ensure amount-in-words updates also on blur (especially for mobile browsers)
        document.querySelectorAll('input[type="text"]').forEach(input => {
            const id = input.id;
            input.addEventListener('blur', () => {
                if (id && id.includes('Investment') || id.includes('Amount') || id.includes('Savings') || id.includes('Debt') || id.includes('Withdrawal')) {
                    const wordsDiv = document.getElementById(id.replace(/(Input|Amount|Savings|Debt|Withdrawal)/, '') + 'Words');
                    if (wordsDiv) updateAmountInWords(id, wordsDiv.id);
                }
            });
        });

</script>
<script>
// Robust helper to parse currency/number inputs
function parseInputNumber(id) {
    const el = document.getElementById(id);
    if (!el) return 0;
    const val = String(el.value || el.placeholder || el.getAttribute('data-default') || '');
    const num = parseFloat(val.replace(/,/g, '').replace(/[^\d.\-]/g, ''));
    return isNaN(num) ? 0 : num;
}

function formatCurrency(val) {
    try {
        const cfg = currencyConfig && currencyConfig[selectedCurrency] ? currencyConfig[selectedCurrency] : {locale: 'en-IN'};
        return new Intl.NumberFormat(cfg.locale || 'en-IN', { minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(Math.round(val));
    } catch(e) {
        return Math.round(val).toString();
    }
}

</script>
</div><script>
// ===== Currency to Words for Strategy Comparison (numberToWords + display) =====
function numberToWordsStrategy(num) {
    if (!isFinite(num)) return "";
    if (num === 0) return "zero";
    const a = ["", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "eleven",
               "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen"];
    const b = ["", "", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"];
    const g = ["", "thousand", "million", "billion", "trillion"];
    let words = "";
    let i = 0;
    num = Math.floor(Math.abs(num));
    while (num > 0) {
        let chunk = num % 1000;
        if (chunk) {
            let chunkWords = "";
            let hundreds = Math.floor(chunk / 100);
            let tensUnits = chunk % 100;
            if (hundreds) chunkWords += a[hundreds] + " hundred ";
            if (tensUnits < 20) chunkWords += a[tensUnits];
            else {
                chunkWords += b[Math.floor(tensUnits / 10)];
                if (tensUnits % 10) chunkWords += "-" + a[tensUnits % 10];
            }
            words = chunkWords.trim() + " " + g[i] + " " + words;
        }
        num = Math.floor(num / 1000);
        i++;
    }
    return words.trim();
}

function displayAmountInWords(inputId, outputId) {
    const input = document.getElementById(inputId);
    const output = document.getElementById(outputId);
    if (!input || !output) return;
    const rawValue = String(input.value || "").replace(/,/g, '').trim();
    const numberValue = parseFloat(rawValue);
    if (isNaN(numberValue) || numberValue === 0) {
        output.textContent = "";
        return;
    }
    let words = numberToWordsStrategy(Math.floor(numberValue));
    const currency = (document.getElementById('globalCurrencySelect') && document.getElementById('globalCurrencySelect').value) || 'INR';
    let currencyWord = "rupees";
    if (currency === "USD") currencyWord = "dollars";
    else if (currency === "EUR") currencyWord = "euros";
    else if (currency === "JPY") currencyWord = "yen";
    // capitalize first letter
    words = words.charAt(0).toUpperCase() + words.slice(1);
    output.textContent = words + " " + currencyWord;
}

// convenience to update all four
function updateStrategyComparisonWords() {
    displayAmountInWords('initialInvestmentA','initialInvestmentAWords');
    displayAmountInWords('recurringAmountA','recurringAmountAWords');
    displayAmountInWords('initialInvestmentB','initialInvestmentBWords');
    displayAmountInWords('recurringAmountB','recurringAmountBWords');
}

// Re-run on currency change (if dropdown exists)
const globalCurrency = document.getElementById && document.getElementById('globalCurrencySelect');
if (globalCurrency) {
    globalCurrency.addEventListener('change', function(){ setTimeout(updateStrategyComparisonWords, 50); });
}

// Ensure called on load after initializers
window.addEventListener('load', function() {
    setTimeout(updateStrategyComparisonWords, 450);
});

// patch showTab to refresh when opening Strategy Comparison
if (typeof showTab === 'function') {
    const _origShowTab = showTab;
    showTab = function(tabId) {
        _origShowTab(tabId);
        if (tabId === 'strategyComparisonTab') {
            setTimeout(updateStrategyComparisonWords, 200);
        }
    }
}

// ===== Simplified compareStrategies (compounded annually) =====
function compareStrategies() {
    if (typeof Chart === 'undefined') {
        console.warn('Chart.js not loaded yet');
    }
    const parseNum = id => parseFloat((document.getElementById(id).value||'0').toString().replace(/,/g,'')) || 0;

    const P_A = parseNum('initialInvestmentA');
    const PMT_A = parseNum('recurringAmountA');
    const t_iA = parseFloat(document.getElementById('investmentDurationA').value) || 0;
    const t_hA = parseFloat(document.getElementById('holdingPeriodA').value) || 0;
    const rA = (parseFloat(document.getElementById('annualReturnA').value) || 0) / 100;
    const P_B = parseNum('initialInvestmentB');
    const PMT_B = parseNum('recurringAmountB');
    const t_iB = parseFloat(document.getElementById('investmentDurationB').value) || 0;
    const t_hB = parseFloat(document.getElementById('holdingPeriodB').value) || 0;
    const rB = (parseFloat(document.getElementById('annualReturnB').value) || 0) / 100;
    const inflation = (parseFloat(document.getElementById('comparisonInflationRate').value) || 0) / 100;

    // avoid division by zero for r
    const annFactor = (r, n) => {
        if (r === 0) return n;
        return (Math.pow(1 + r, n) - 1) / r;
    };

    const FV_A = P_A * Math.pow(1 + rA, t_hA) + PMT_A * annFactor(rA, t_iA);
    const FV_B = P_B * Math.pow(1 + rB, t_hB) + PMT_B * annFactor(rB, t_iB);

    const totalContribA = P_A + PMT_A * t_iA;
    const totalContribB = P_B + PMT_B * t_iB;
    const totalGainsA = FV_A - totalContribA;
    const totalGainsB = FV_B - totalContribB;
    const FV_Real_A = FV_A / Math.pow(1 + inflation, t_hA || 1);
    const FV_Real_B = FV_B / Math.pow(1 + inflation, t_hB || 1);

    const currencySymbol = (document.querySelector('#globalCurrencySelect option:checked') && document.querySelector('#globalCurrencySelect option:checked').dataset.symbol) || '';

    // Update table cells if they exist
    const setText = (id, val) => { const el = document.getElementById(id); if (el) el.textContent = (currencySymbol + Number(val).toLocaleString()); };
    setText('comparisonFutureValueNominalA', FV_A);
    setText('comparisonFutureValueNominalB', FV_B);
    setText('comparisonFutureValueRealA', FV_Real_A);
    setText('comparisonFutureValueRealB', FV_Real_B);
    setText('comparisonTotalContributionsA', totalContribA);
    setText('comparisonTotalContributionsB', totalContribB);
    setText('comparisonTotalGainsA', totalGainsA);
    setText('comparisonTotalGainsB', totalGainsB);
    setText('comparisonFinalValueA', FV_Real_A);
    setText('comparisonFinalValueB', FV_Real_B);

    // reveal results section
    const resSec = document.getElementById('strategyComparisonResultsSection');
    if (resSec) resSec.style.display = 'block';

    // Chart update
    try {
        const ctx = document.getElementById('comparisonChart').getContext('2d');
        if (window.comparisonChartInstance) window.comparisonChartInstance.destroy();
        window.comparisonChartInstance = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Future Value (Nominal)', 'Future Value (Real)', 'Total Contributions', 'Total Gains'],
                datasets: [
                    { label: 'Strategy A', data: [FV_A, FV_Real_A, totalContribA, totalGainsA], backgroundColor: ['rgba(102,126,234,0.8)'] },
                    { label: 'Strategy B', data: [FV_B, FV_Real_B, totalContribB, totalGainsB], backgroundColor: ['rgba(118,75,162,0.8)'] }
                ]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'top' }, title: { display: true, text: 'Strategy Comparison Results' } }, scales: { y: { beginAtZero: true } } }
        });
    } catch (e) {
        console.warn('Chart draw error', e);
    }
}
</script></body>
</html>
