<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Blog</title>

<!-- Simple styling -->
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
        max-width: 900px;
        margin-left: auto;
        margin-right: auto;
    }
    h1 {
        margin-bottom: 20px;
    }
    #blog-list a {
        display: block;
        padding: 10px 0;
        font-size: 1.1em;
        text-decoration: none;
        color: blue;
    }
    #blog-list a:hover {
        text-decoration: underline;
    }
    #blog-content {
        margin-top: 40px;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 10px;
    }
</style>

<!-- Load Markdown rendering library -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>

<h1>Blog Posts</h1>

<!-- Blog Links -->
<div id="blog-list">Loading posts...</div>

<!-- Blog Content Viewer -->
<div id="blog-content"></div>

<script>
// ===== SETTINGS =====
const BLOG_FOLDER = "/blogs/";     // location of md files
const MAX_POSTS = 200;             // safety limit - adjust as needed

// ===== STEP 1: Discover Markdown files =====
// Static hosting cannot read folder contents, so we "guess" filenames (blog_01.md, blog_02.md...)
async function discoverPosts() {
    let posts = [];
    for (let i = 1; i <= MAX_POSTS; i++) {
        const file = `blog_${String(i).padStart(2, '0')}.md`;
        const url = BLOG_FOLDER + file;

        try {
            const res = await fetch(url);
            if (res.ok) posts.push(file);
        } catch (e) { }
    }
    return posts;
}

// ===== STEP 2: Render links =====
function renderPostList(postFiles) {
    const listDiv = document.getElementById("blog-list");

    if (postFiles.length === 0) {
        listDiv.innerHTML = "<p>No blog posts found.</p>";
        return;
    }

    listDiv.innerHTML = "";
    postFiles.forEach(file => {
        const a = document.createElement("a");
        a.href = "#";
        a.textContent = file.replace(".md", "").replace(/_/g, " ").toUpperCase();
        a.onclick = () => loadPost(file);
        listDiv.appendChild(a);
    });
}

// ===== STEP 3: Load + Render Markdown =====
async function loadPost(filename) {
    const contentDiv = document.getElementById("blog-content");
    contentDiv.innerHTML = "<p>Loading...</p>";

    const url = BLOG_FOLDER + filename;

    try {
        const res = await fetch(url);
        const text = await res.text();

        // Convert markdown â†’ HTML
        const html = marked.parse(text);
        contentDiv.innerHTML = html;
        window.scrollTo({ top: 0, behavior: "smooth" });
    } catch (err) {
        contentDiv.innerHTML = "<p>Failed to load blog.</p>";
    }
}

// ===== MAIN STARTUP =====
(async () => {
    const posts = await discoverPosts();
    renderPostList(posts);
})();
</script>

</body>
</html>
